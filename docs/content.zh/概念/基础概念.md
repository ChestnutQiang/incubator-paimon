---
title: "基础概念"
weight: 2
type: docs
aliases:
- /概念/基础概念.html
---
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

# 基础概念

## 快照

快照捕获了一个表在某个时间点上的状态。用户可以通过最新的快照来访问一个表的最新数据。通过时间旅行，用户也可以通过较早的快照访问表的先前状态。

## 分区

Paimon采用了与Apache Hive相同的分区概念来分离数据。

分区是一种可选的方式，根据日期、城市和部门等特定列的值将表划分为相关部分。每个表可以有一个或多个分区键来识别一个特定的分区。

通过分区，用户可以有效地对表中的某一片段记录进行操作。参见[文件布局]({{< ref "概念/文件布局" >}})，了解文件如何被划分为多个分区。

{{< hint info >}}

如果定义了主键，分区键必须是主键的一个子集。

{{< /hint >}}

## Bucket

未分区的表，或分区表中的分区，被细分为桶，为数据提供额外的结构，可用于更有效的查询。

一个桶的范围是由记录中的一个或多个列的哈希值决定的。用户可以通过提供[`bucket-key` option]({{< ref "maintenance/configurations#coreoptions" >}})指定桶的列。如果没有指定 `bucket-key` option 选项，主键（如果定义了）或完整记录将被用作桶键。

一个桶是最小的读写存储单元，所以桶的数量限制了最大的处理并行性。不过，这个数字不应该太大，因为它将导致大量的小文件和低读取性能。一般来说，建议每个桶的数据大小约为1GB。

参见[文件布局]({{< ref "概念/文件布局" >}})，了解文件如何被划分到桶中。另外，如果你想在创建表后调整桶的数量，请参见 [rescale bucket](https://paimon.apache.org/docs/master/maintenance/rescale-bucket/) 。

## Consistency Guarantees

Paimon写入器使用两阶段提交协议，将一批记录原子化地提交到表中。每次提交时最多产生两个[snapshots]({{< ref "概念/基础概念#snapshot" >}})。

对于任何两个同时修改表的写手来说，只要他们不修改同一个桶，他们的提交是可序列化的。如果他们修改了同一个桶，则只能保证快照的隔离。也就是说，最终的表状态可能是两个提交的混合体，但不会丢失任何变化。
